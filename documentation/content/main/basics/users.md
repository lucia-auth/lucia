---
_order: 0
title: "Users"
description: "Learn about users in Lucia"
---

Users are stored in your database and are represented by a `User` object within Lucia:

```ts
const user = {
	userId: "laRZ8RgA34YYcgj"
};
```

### User id

The primary way to identify users is by their user id. It's randomly generated by Lucia and it's 15 characters long. You can of course configure it to generate your own user id.

> With the default option, you can create just over 100 billion users before you have thousandths of a percent chance of encountering collision!

### User attributes

By default, only the user id is stored in the user object. Other fields are called _user attributes_ and you can configure your database and Lucia to store additional custom data (email, username, etc). But keep in mind that you should only store as much as you need, and fields unrelated to the authorization process (like the user's submission) should be stored in a separate table.

## Create users

[`createUser()`](/reference/lucia-auth/auth#createuser) can be used to create users. This takes an option for the primary key to be created with the user.

```ts
import { auth } from "./lucia.js";

await auth.createUser({
	primaryKey: {
		providerId,
		providerUserId,
		password
	},
	attributes
});
```

`attributes` should be an empty object with default configuration. Refer to [User attributes](/basics/user-attributes) to learn more about storing custom data.

Refer to [Keys](/basics/keys) to learn more about keys.

### Create a primary key

You can create primary keys alongside the user, which will be used when authenticating the user.

#### With a password key

This is useful when you can't trust the provider to give you the correct information. For example, in a simple username/password authentication, your users are the provider and you have to validate the identity by using passwords.

Lucia will handle the password hashing.

```ts
import { auth } from "./lucia.js";

try {
	await auth.createUser({
		primaryKey: {
			providerId: "username", // provider id = authentication method
			providerUserId: usernameInput, // the user's username is unique to the user
			password: passwordInput
		},
		attributes: {}
	});
} catch {
	// invalid input
}
```

> (warn) Make sure to implement a proper password strength control. See the checklist in the [OWASP Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Authentication_Cheat_Sheet.html#implement-proper-password-strength-controls).

#### Without a password key

This is useful when you can trust the input for the provider id and provider user id. When implementing OAuth, for example, you can trust that the provider has validated the user and has given you the correct provider user id (you will never get the information about user B when user A signs in with the OAuth provider).

```ts
import { auth } from "./lucia.js";

try {
	await auth.createUser({
		primaryKey: {
			providerId: "github", // provider id = authentication method
			providerUserId: githubUserId, // the user's Github user id is unique to the user
			password: null
		},
		attributes: {}
	});
} catch {
	// invalid input
}
```

### With user attributes

You can define the user's attributes in `attributes`.

```ts
import { auth } from "./lucia.js";

try {
	await auth.createUser({
		primaryKey: {
			// ...
		},
		attributes: {
			username: "user1234",
			profile: null
		}
	});
} catch {
	// invalid input
}
```

### Without creating a key

If you _just_ need to store users and authenticate users by yourself, you can set `primaryKey` to `null`. **`createUser()` is the only way to create primary keys.** Avoid doing this if you plan on using keys later or are unsure.

## Get users

[`getUser()`](/reference/lucia-auth/auth#getuser) can be used to get a user from a user id. This will throw an error if the user isnâ€™t found.

```ts
import { auth } from "./lucia.js";

const user = await auth.getUser(userId);
```

## Update user attributes

A user's attributes can be updated using [`updateUserAttributes()`](/reference/lucia-auth/auth#updateuserattributes). Only the user data attribute (column) that needs to updated needs to be passed.

> (red) **Make sure to invalidate all sessions of the user on password or privilege level change.** You can create a new session to prevent the current user from being logged out.

```ts
import { auth } from "./lucia.js";

const user = await auth.updateUserAttributes(userId, partialUserAttributes);

await auth.invalidateAllUserSessions(user.userId);
const session = await auth.createSession(user.userId);
// store new session
```

#### Example

```ts
import { auth } from "./lucia.js";

try {
	const user = await auth.updateUserAttributes(userId, {
		username: "user1234",
		profile_picture: null
	});
} catch {
	// invalid input
}
```

## Delete users

Users can be deleted using [`deleteUser()`](/reference/lucia-auth/auth#deleteuser). All sessions and keys of the target user will be deleted. This method will succeed regardless of the validity of the user id.

```ts
import { auth } from "./lucia.js";

const user = auth.deleteUser(userId);
```

## Configure users

### Custom user id generation

You can generate your own user ids by setting [`generateCustomUserId()`](/basics/configuration#generatecustomuserid), which can either be synchronous or asynchronous.

If you need to generate a cryptographically random alphanumeric string, Lucia provides [`generateRandomString()`](/reference/lucia-auth/lucia-auth#generaterandomstring). This function is based on the [`nanoid`](https://github.com/ai/nanoid) package.

```ts
import { generateCustomUserId } from "lucia-auth";

lucia({
	generateCustomUserId: () => {
		return `user_${generateCustomUserId(8)}`; // example result: "user_yhwKf2yn"
	}
});
```

Other options include:

- [Universally unique identifier (UUID)](https://developer.mozilla.org/en-US/docs/Web/API/Crypto/randomUUID)
- [CUID](https://www.npmjs.com/package/@paralleldrive/cuid2)
